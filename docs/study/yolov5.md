# Yolov5Ê®°ÂûãËÆ≠ÁªÉ

> [ YOLOv5 üöÄ](https://github.com/ultralytics/yolov5?tab=readme-ov-file)ÊòØ‰∏ÄÁßçÊ∑±Â∫¶Â≠¶‰π†Ê®°ÂûãÔºåÁî®‰∫éÁâ©‰ΩìÊ£ÄÊµã‰ªªÂä°„ÄÇÂÆÉÁöÑÂÖ®Áß∞ÊòØ‚Äú‰Ω†Âè™Áúã‰∏ÄÊ¨°‚ÄùÔºàYou Only Look OnceÔºâÔºåÂèØ‰ª•Âø´ÈÄü‰∏îÂáÜÁ°ÆÂú∞ËØÜÂà´ÂõæÂÉè‰∏≠ÁöÑÁâ©‰ΩìÂπ∂Ê†áËÆ∞ÂÆÉ‰ª¨ÁöÑ‰ΩçÁΩÆ„ÄÇ

## Yolov5ÁöÑÈÖçÁΩÆ‰ΩøÁî®ÊÄùË∑Ø

![1715738894097](yoloËÆ≠ÁªÉ/1715738894097.png)

## ÂÆâË£ÖÊòæÂç°È©±Âä®

> ÁîµËÑëÁâàÊú¨‰∏çÂêåÂèØËÉΩÊúâ‰∫õÂêçÁß∞‰∏ç‰∏ÄÊ†∑Ôºå‰∏ªË¶ÅÊòØÊâæÂà∞ËÆæÂ§áÁÆ°ÁêÜÂô®„ÄÇ

### Á°ÆÂÆöÊòæÂç°ÁâàÊú¨

ÊâæÂà∞ÊéßÂà∂Èù¢Êùø-->Á°¨‰ª∂‰∏éÂ£∞Èü≥-->**ËÆæÂ§áÁÆ°ÁêÜÂô®**-->ÊòæÁ§∫ÈÄÇÈÖçÂô®-->ÊòæÂç°ÁâàÊú¨

ËøôÈáåÊòæÁ§∫ÁâàÊú¨ÔºåËØ¥ÊòéÁîµËÑëÊúâËã±‰ºüËææÁöÑÊòæÂç°

![1715739135356](yoloËÆ≠ÁªÉ/1715739135356.png)

ÁÑ∂ÂêéÂèØ‰ª•ÂéªËã±‰ºüËææÈ©±Âä®ÊéßÂà∂Èù¢ÊùøÔºåÂÜçÊü•Áúã‰∏Ä‰∏ãÂÖ∑‰ΩìÁâàÊú¨Âè∑„ÄÇ

![1715739492856](yoloËÆ≠ÁªÉ/1715739492856.png)

### ÂÆâË£ÖÊòæÂç°È©±Âä®

‰∏ãËΩΩÂú∞ÂùÄLÔºö[ÂÆòÊñπÈ©±Âä® | NVIDIA](https://www.nvidia.cn/Download/index.aspx?lang=cn#)

![1715739635564](yoloËÆ≠ÁªÉ/1715739635564.png)

![1715739700051](yoloËÆ≠ÁªÉ/1715739700051.png)

   ÂÆâË£ÖÔºàÊõ¥Êñ∞ÔºâÂ•Ω‰∫ÜÊòæÂç°È©±Âä®‰ª•Âêé„ÄÇÊåâ‰∏ãwin+RÁªÑÂêàÈîÆÔºåÊâìÂºÄcmdÂëΩ‰ª§Á™óÂè£ÔºåÊü•ÁúãÊúÄÈ´òÊîØÊåÅÁöÑCUDAÁâàÊú¨

```undefined
nvidia-smi
```

![1715739847591](yoloËÆ≠ÁªÉ/1715739847591.png)

## AnacondaÁéØÂ¢ÉÈÖçÁΩÆ

> PythonÁéØÂ¢ÉÈÖçÁΩÆÔºö
>
> ÈìæÊé•Ôºöhttps://pan.baidu.com/s/1WBBtduC-grJw9ZM88HqXfg?pwd=cmzz 
> ÊèêÂèñÁ†ÅÔºöcmzz

**Ê∑ªÂä†Ëß£ÈáäÂô®**

![1715740149077](yoloËÆ≠ÁªÉ/1715740149077.png)



![1715740219475](yoloËÆ≠ÁªÉ/1715740219475.png)

![1715740272867](yoloËÆ≠ÁªÉ/1715740272867.png)

## ÂàõÂª∫ËôöÊãüÁéØÂ¢É

### Êü•ÁúãËôöÊãüÁéØÂ¢É

![1715740331312](yoloËÆ≠ÁªÉ/1715740331312.png)

ËøôÈáåÊúâ‰∏Ä‰∏™ÈáçË¶ÅÂëΩ‰ª§ÔºåÊü•ÁúãÂΩìÂâçÁöÑËôöÊãüÁéØÂ¢ÉÊï∞ÈáèÔºåÈªòËÆ§Âè™Êúâ‰∏Ä‰∏™`base`(ÊàëËøôÈáåÂÆâË£ÖËøáÂÖ∂‰ªñËôöÊãüÁéØÂ¢É)

```shell
conda env list
```

![1715740465753](yoloËÆ≠ÁªÉ/1715740465753.png)

### ÂàõÂª∫pytorchËôöÊãüÁéØÂ¢É

ÔºÅÔºÅÔºÅÈ¶ñÂÖàÊü•Áúã‰∏Ä‰∏ãËá™Â∑±pythonÁâàÊú¨

![1715740640863](yoloËÆ≠ÁªÉ/1715740640863.png)

ËæìÂÖ•‰ª•‰∏ã‰ª£Á†ÅÈÄÄÂá∫python

```python
quit()
```

![1715740721033](yoloËÆ≠ÁªÉ/1715740721033.png)

ÂàõÂª∫ËôöÊãüÁéØÂ¢ÉÔºåËæìÂÖ•‰ª•‰∏ãÂëΩ‰ª§ÔºåÊ≥®ÊÑèpythonÁâàÊú¨ÂíåËá™Â∑±ÁöÑ‰∏ÄËá¥

```shell
conda create -n pytorch python=3.11.9
```

ËæìÂÖ•y

![img](yoloËÆ≠ÁªÉ/20210818192201248.png)

ÂÜçÊ¨°Áî®ÂâçÈù¢ÁöÑÂëΩ‰ª§Êü•Áúã‰ºöÂ§ö‰∏Ä‰∏™ÁéØÂ¢ÉÔºå‰ΩøÁî®‰∏ãÈù¢ÂëΩ‰ª§ÊøÄÊ¥ªÁéØÂ¢É

```shell
conda activate pytorch
```

### Êõ¥Êç¢ÈïúÂÉèÊ∫ê

Ê∏ÖÂçéÊ∫ê

```
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/
conda config --set show_channel_urls yes
```

### ‰∏ãËΩΩpytorch

> ÂÆòÁΩëÔºö[PyTorch](https://pytorch.org/)

![1715741096130](yoloËÆ≠ÁªÉ/1715741096130.png)

Á≠âÂæÖ‰∏ãËΩΩÂÆåÊàêÂç≥ÂèØ„ÄÇ

### ÂàáÊç¢Ëß£ÈáäÂô®

‰ΩøÁî®`AnacondaÁéØÂ¢ÉÈÖçÁΩÆ`ÈÉ®ÂàÜÂÜÖÂÆπÊ∑ªÂä†Ëß£ÈáäÂô®ÔºåÂπ∂ÂàáÊç¢Âà∞pytorchËß£ÈáäÂô®„ÄÇ

## ÂÆâË£Öyolov5‰æùËµñ

### ‰∏ãËΩΩyolov5Ê∫ê‰ª£Á†Å

yolov5‰∏ãËΩΩÂú∞ÂùÄÔºö[ YOLOv5 üöÄ](https://github.com/ultralytics/yolov5)

![1715741590849](yoloËÆ≠ÁªÉ/1715741590849.png)

### ÂÆâË£Ö‰æùËµñ

‰ª•Â∑•Á®ãÊâìÂºÄyolov5Êñá‰ª∂Â§π

![1715742381469](yoloËÆ≠ÁªÉ/1715742381469.png)

ÂÆâË£Ö‰æùËµñ

![1715742517367](yoloËÆ≠ÁªÉ/1715742517367.png)

Â¶ÇÊûú‰∏ãËΩΩÊØîËæÉÊÖ¢ÔºåÂèØ‰ª•‰ΩøÁî®‰∏≠ÁßëÂ§ßÈïúÂÉèÊ∫êÔºåÊ∞∏‰πÖÊõøÊç¢

```shell
pip config set global.index-url https://pypi.mirrors.ustc.edu.cn/simple
```

### È™åËØÅ

ÁªàÁ´ØËæìÂÖ•ÂëΩ‰ª§

```shell
python detect.py --source 0
```

![1715742758603](yoloËÆ≠ÁªÉ/1715742758603.png)

## Ê†áËÆ∞Êï∞ÊçÆÈõÜ

### ÂÆâË£Ölabelimg

```shell
pip install labelimg
```

![1715782550393](yoloËÆ≠ÁªÉ/1715782550393.png)

### Ê†áËÆ∞Êï∞ÊçÆÈõÜ

ÂàõÂª∫Êñá‰ª∂Â§πÁªìÊûÑ---ÂàõÂª∫Êñá‰ª∂Â§πVOCdevkitÔºåÂÜçÊ¨°Êñá‰ª∂Â§π‰∏ãÊñ∞Âª∫VOC2007ÔºåÂÖ∂‰ªñÂ¶Ç‰∏ã

```
‚îú‚îÄ‚îÄ VOC2007
‚îÇ‚îú‚îÄ‚îÄ JPEGImages  Â≠òÊîæÈúÄË¶ÅÊâìÊ†áÁ≠æÁöÑÂõæÁâáÊñá‰ª∂
‚îÇ‚îú‚îÄ‚îÄ Annotations  Â≠òÊîæÊ†áÊ≥®ÁöÑÊ†áÁ≠æÊñá‰ª∂
‚îÇ‚îú‚îÄ‚îÄ predefined_classes.txt  ÂÆö‰πâËá™Â∑±Ë¶ÅÊ†áÊ≥®ÁöÑÊâÄÊúâÁ±ªÂà´
```

![1715742994148](yoloËÆ≠ÁªÉ/1715742994148.png)

Ê†πÊçÆ‰∏äÈù¢Ê†áÊ≥®ÔºåÊääÁÖßÁâáÊîæÂà∞`JPEGImages`Êñá‰ª∂Â§π

Â∞ÜË¶ÅÊ†áÊ≥®ÁöÑÊâÄÊúâÁ±ªÂà´ÊîæÂú®`predefined_classes.txt`Êñá‰ª∂

![1715781741270](yoloËÆ≠ÁªÉ/1715781741270.png)

Âú®ÁªàÁ´Ø‰∏≠ÊâìÂºÄlabelimg

![1715782631265](yoloËÆ≠ÁªÉ/1715782631265.png)

**‰∏Ä‰∫õÂ∏∏Áî®Âø´Êç∑ÈîÆÔºö**

- AÔºöÂàáÊç¢Âà∞‰∏ä‰∏ÄÂº†ÂõæÁâá
- DÔºöÂàáÊç¢Âà∞‰∏ã‰∏ÄÂº†ÂõæÁâá
- WÔºöË∞ÉÂá∫Ê†áÊ≥®ÂçÅÂ≠óÊû∂
- del ÔºöÂà†Èô§Ê†áÊ≥®Ê°ÜÊ°Ü
- Ctrl+uÔºöÈÄâÊã©Ê†áÊ≥®ÁöÑÂõæÁâáÊñá‰ª∂Â§π
- Ctrl+rÔºöÈÄâÊã©Ê†áÊ≥®Â•ΩÁöÑlabelÊ†áÁ≠æÂ≠òÂú®ÁöÑÊñá‰ª∂Â§π

![1715782773911](yoloËÆ≠ÁªÉ/1715782773911.png)

## ÂàíÂàÜÊï∞ÊçÆÈõÜ

> Ëøô‰∏ÄÊ≠•ÈúÄË¶ÅÂ∞ÜÊ†áËÆ∞Â•ΩÁöÑÁÖßÁâáÂíåÊ†áÁ≠æÊåâ‰∏ÄÂÆöÊØî‰æãÂàíÂàÜ‰∏∫ÊµãËØïÈõÜÂíåËÆ≠ÁªÉÈõÜÔºåÁî®‰∫éÂêéÁª≠Ê®°ÂûãËÆ≠ÁªÉ„ÄÇ
>
> ‚ö†‚ö†‚ö†---ÁÖßÁâáÂíåÊ†áÁ≠æÊï∞ÈáèÂíåÂêçÁß∞Ë¶Å‰∏ÄÁõ¥ÔºåÂê¶Âàô‰ºöÂá∫Èîô„ÄÇ

### ‰ª£Á†ÅÂèÇÊï∞‰øÆÊîπ

ÂàíÂàÜÊï∞ÊçÆÈõÜ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö

```python
import xml.etree.ElementTree as ET
import pickle
import os
from os import listdir, getcwd
from os.path import join
import random
from shutil import copyfile

classes = [
    "cap"
]


TRAIN_RATIO = 80


def clear_hidden_files(path):
    dir_list = os.listdir(path)
    for i in dir_list:
        abspath = os.path.join(os.path.abspath(path), i)
        if os.path.isfile(abspath):
            if i.startswith("._"):
                os.remove(abspath)
        else:
            clear_hidden_files(abspath)


def convert(size, box):
    dw = 1. / size[0]
    dh = 1. / size[1]
    x = (box[0] + box[1]) / 2.0
    y = (box[2] + box[3]) / 2.0
    w = box[1] - box[0]
    h = box[3] - box[2]
    x = x * dw
    w = w * dw
    y = y * dh
    h = h * dh
    return (x, y, w, h)


def convert_annotation(image_id):
    in_file = open('VOCdevkit/VOC2007/Annotations/%s.xml' % image_id, encoding='utf-8')
    out_file = open('VOCdevkit/VOC2007/YOLOLabels/%s.txt ' % image_id, 'w')
    tree = ET.parse(in_file)
    root = tree.getroot()
    size = root.find('size')
    w = int(size.find('width').text)
    h = int(size.find('height').text)

    for obj in root.iter('object'):
        difficult = obj.find('difficult').text
        cls = obj.find('name').text
        if cls not in classes or int(difficult) == 1:
            continue
        cls_id = classes.index(cls)
        xmlbox = obj.find('bndbox')
        b = (float(xmlbox.find('xmin').text), float(xmlbox.find('xmax').text), float(xmlbox.find('ymin').text),
             float(xmlbox.find('ymax').text))
        bb = convert((w, h), b)
        out_file.write(str(cls_id) + " " + " ".join([str(a) for a in bb]) + '\n')
    in_file.close()
    out_file.close()


wd = os.getcwd()
wd = os.getcwd()
data_base_dir = os.path.join(wd, "VOCdevkit/")
if not os.path.isdir(data_base_dir):
    os.mkdir(data_base_dir)
work_sapce_dir = os.path.join(data_base_dir, "VOC2007/")
if not os.path.isdir(work_sapce_dir):
    os.mkdir(work_sapce_dir)
annotation_dir = os.path.join(work_sapce_dir, "Annotations/")
if not os.path.isdir(annotation_dir):
    os.mkdir(annotation_dir)
clear_hidden_files(annotation_dir)
image_dir = os.path.join(work_sapce_dir, "JPEGImages/")
if not os.path.isdir(image_dir):
    os.mkdir(image_dir)
clear_hidden_files(image_dir)
yolo_labels_dir = os.path.join(work_sapce_dir, "YOLOLabels/")
if not os.path.isdir(yolo_labels_dir):
    os.mkdir(yolo_labels_dir)
clear_hidden_files(yolo_labels_dir)
yolov5_images_dir = os.path.join(data_base_dir, "images/")
if not os.path.isdir(yolov5_images_dir):
    os.mkdir(yolov5_images_dir)
clear_hidden_files(yolov5_images_dir)
yolov5_labels_dir = os.path.join(data_base_dir, "labels/")
if not os.path.isdir(yolov5_labels_dir):
    os.mkdir(yolov5_labels_dir)
clear_hidden_files(yolov5_labels_dir)
yolov5_images_train_dir = os.path.join(yolov5_images_dir, "train/")
if not os.path.isdir(yolov5_images_train_dir):
    os.mkdir(yolov5_images_train_dir)
clear_hidden_files(yolov5_images_train_dir)
yolov5_images_test_dir = os.path.join(yolov5_images_dir, "val/")
if not os.path.isdir(yolov5_images_test_dir):
    os.mkdir(yolov5_images_test_dir)
clear_hidden_files(yolov5_images_test_dir)
yolov5_labels_train_dir = os.path.join(yolov5_labels_dir, "train/")
if not os.path.isdir(yolov5_labels_train_dir):
    os.mkdir(yolov5_labels_train_dir)
clear_hidden_files(yolov5_labels_train_dir)
yolov5_labels_test_dir = os.path.join(yolov5_labels_dir, "val/")
if not os.path.isdir(yolov5_labels_test_dir):
    os.mkdir(yolov5_labels_test_dir)
clear_hidden_files(yolov5_labels_test_dir)

train_file = open(os.path.join(wd, "yolov5_train.txt"), 'w')
test_file = open(os.path.join(wd, "yolov5_val.txt"), 'w')
train_file.close()
test_file.close()
train_file = open(os.path.join(wd, "yolov5_train.txt"), 'a')
test_file = open(os.path.join(wd, "yolov5_val.txt"), 'a')
list_imgs = os.listdir(image_dir)  # list image files
prob = random.randint(1, 100)
print("Probability: %d" % prob)
for i in range(0, len(list_imgs)):
    path = os.path.join(image_dir, list_imgs[i])
    if os.path.isfile(path):
        image_path = image_dir + list_imgs[i]
        voc_path = list_imgs[i]
        (nameWithoutExtention, extention) = os.path.splitext(os.path.basename(image_path))
        (voc_nameWithoutExtention, voc_extention) = os.path.splitext(os.path.basename(voc_path))
        annotation_name = nameWithoutExtention + '.xml'
        annotation_path = os.path.join(annotation_dir, annotation_name)
        label_name = nameWithoutExtention + '.txt'
        label_path = os.path.join(yolo_labels_dir, label_name)
    prob = random.randint(1, 100)
    print("Probability: %d" % prob)
    if (prob < TRAIN_RATIO):  # train dataset
        if os.path.exists(annotation_path):
            train_file.write(image_path + '\n')
            convert_annotation(nameWithoutExtention)  # convert label
            copyfile(image_path, yolov5_images_train_dir + voc_path)
            copyfile(label_path, yolov5_labels_train_dir + label_name)
    else:  # test dataset
        if os.path.exists(annotation_path):
            test_file.write(image_path + '\n')
            convert_annotation(nameWithoutExtention)  # convert label
            copyfile(image_path, yolov5_images_test_dir + voc_path)
            copyfile(label_path, yolov5_labels_test_dir + label_name)
train_file.close()
test_file.close()
```

ÈúÄË¶Å‰øÆÊîπÁöÑÂèÇÊï∞Â¶Ç‰∏ãÂõæÔºö

![1715783424367](yoloËÆ≠ÁªÉ/1715783424367.png)

### ÂàíÂàÜÊï∞ÊçÆÈõÜ

Â∞Ü‰ª£Á†ÅÊîæÂú®`select.py`Êñá‰ª∂‰∏≠ÔºåÂπ∂‰∏î**‰∏éVOCdevkitÊñá‰ª∂Â§πÂ§Ñ‰∫éÂêåÁ∫ßÁõÆÂΩï**ÔºåÁÑ∂ÂêéÁõ¥Êé•ËøêË°å‰ª£Á†ÅÂç≥ÂèØÔºö

![1715783557898](yoloËÆ≠ÁªÉ/1715783557898.png)

ÂàíÂàÜÁªìÊûúÔºö

![1715783836032](yoloËÆ≠ÁªÉ/1715783836032.png)

### ÁßªÂä®Ëá≥Â∑•Á®ãÊñá‰ª∂Â§π

Â∞ÜVOCdevkitÊï¥‰∏™Êñá‰ª∂Â§πÁöÑÂÜÖÂÆπÂ§çÂà∂Âà∞yoloÂ∑•Á®ãÁöÑÊ†πÁõÆÂΩï‰∏ãÔºö

![1715783914410](yoloËÆ≠ÁªÉ/1715783914410.png)

## ‰øÆÊîπyoloÊñá‰ª∂ÂèÇÊï∞

ÊâæÂà∞`data`Êñá‰ª∂Â§π‰∏ãÁöÑ`coco128.yaml`Êñá‰ª∂

![1715784046921](yoloËÆ≠ÁªÉ/1715784046921.png)

‰øÆÊîπÊñá‰ª∂ÂèÇÊï∞

![1715784158206](yoloËÆ≠ÁªÉ/1715784158206.png)

ÊâæÂà∞`models`Êñá‰ª∂Â§π‰∏ãÁöÑyolov5s.yamlÊñá‰ª∂

> ËøôÈáåËøòÊúân„ÄÅxÁ≠âÁ±ªÂûãÁöÑÔºåÂÖ∑‰ΩìÂå∫Âà´ÂèØ‰ª•ÂèÇËÄÉGithubÁöÑÊï∞ÊçÆÊõ≤Á∫ø„ÄÇ

![1715784224796](yoloËÆ≠ÁªÉ/1715784224796.png)

‰øÆÊîπÊ†áÁ≠æÊï∞ÈáèÂèÇÊï∞Ôºö

![1715784376823](yoloËÆ≠ÁªÉ/1715784376823.png)

ÊâìÂºÄ`train.py`Êñá‰ª∂

![1715784461867](yoloËÆ≠ÁªÉ/1715784461867.png)

ÊâæÂà∞`parse_opt`ÂáΩÊï∞ÔºåËøôÈáåÈù¢ÊúâÊ®°ÂûãÁöÑ‰∏ªË¶ÅÂèÇÊï∞Ôºö

```python
def parse_opt(known=False):
    """Parses command-line arguments for YOLOv5 training, validation, and testing."""
    parser = argparse.ArgumentParser()
    parser.add_argument("--weights", type=str, default=ROOT / "yolov5s.pt", help="initial weights path")
    parser.add_argument("--cfg", type=str, default="", help="model.yaml path")
    parser.add_argument("--data", type=str, default=ROOT / "data/coco128.yaml", help="dataset.yaml path")
    parser.add_argument("--hyp", type=str, default=ROOT / "data/hyps/hyp.scratch-low.yaml", help="hyperparameters path")
    parser.add_argument("--epochs", type=int, default=10, help="total training epochs")
    parser.add_argument("--batch-size", type=int, default=8, help="total batch size for all GPUs, -1 for autobatch")
    parser.add_argument("--imgsz", "--img", "--img-size", type=int, default=320, help="train, val image size (pixels)")
    parser.add_argument("--rect", action="store_true", help="rectangular training")
    parser.add_argument("--resume", nargs="?", const=True, default=False, help="resume most recent training")
    parser.add_argument("--nosave", action="store_true", help="only save final checkpoint")
    parser.add_argument("--noval", action="store_true", help="only validate final epoch")
    parser.add_argument("--noautoanchor", action="store_true", help="disable AutoAnchor")
    parser.add_argument("--noplots", action="store_true", help="save no plot files")
    parser.add_argument("--evolve", type=int, nargs="?", const=300, help="evolve hyperparameters for x generations")
    parser.add_argument(
        "--evolve_population", type=str, default=ROOT / "data/hyps", help="location for loading population"
    )
    parser.add_argument("--resume_evolve", type=str, default=None, help="resume evolve from last generation")
    parser.add_argument("--bucket", type=str, default="", help="gsutil bucket")
    parser.add_argument("--cache", type=str, nargs="?", const="ram", help="image --cache ram/disk")
    parser.add_argument("--image-weights", action="store_true", help="use weighted image selection for training")
    parser.add_argument("--device", default="", help="cuda device, i.e. 0 or 0,1,2,3 or cpu")
    parser.add_argument("--multi-scale", action="store_true", help="vary img-size +/- 50%%")
    parser.add_argument("--single-cls", action="store_true", help="train multi-class data as single-class")
    parser.add_argument("--optimizer", type=str, choices=["SGD", "Adam", "AdamW"], default="SGD", help="optimizer")
    parser.add_argument("--sync-bn", action="store_true", help="use SyncBatchNorm, only available in DDP mode")
    parser.add_argument("--workers", type=int, default=8, help="max dataloader workers (per RANK in DDP mode)")
    parser.add_argument("--project", default=ROOT / "runs/train", help="save to project/name")
    parser.add_argument("--name", default="exp", help="save to project/name")
    parser.add_argument("--exist-ok", action="store_true", help="existing project/name ok, do not increment")
    parser.add_argument("--quad", action="store_true", help="quad dataloader")
    parser.add_argument("--cos-lr", action="store_true", help="cosine LR scheduler")
    parser.add_argument("--label-smoothing", type=float, default=0.0, help="Label smoothing epsilon")
    parser.add_argument("--patience", type=int, default=100, help="EarlyStopping patience (epochs without improvement)")
    parser.add_argument("--freeze", nargs="+", type=int, default=[0], help="Freeze layers: backbone=10, first3=0 1 2")
    parser.add_argument("--save-period", type=int, default=-1, help="Save checkpoint every x epochs (disabled if < 1)")
    parser.add_argument("--seed", type=int, default=0, help="Global training seed")
    parser.add_argument("--local_rank", type=int, default=-1, help="Automatic DDP Multi-GPU argument, do not modify")

    # Logger arguments
    parser.add_argument("--entity", default=None, help="Entity")
    parser.add_argument("--upload_dataset", nargs="?", const=True, default=False, help='Upload data, "val" option')
    parser.add_argument("--bbox_interval", type=int, default=-1, help="Set bounding-box image logging interval")
    parser.add_argument("--artifact_alias", type=str, default="latest", help="Version of dataset artifact to use")

    # NDJSON logging
    parser.add_argument("--ndjson-console", action="store_true", help="Log ndjson to console")
    parser.add_argument("--ndjson-file", action="store_true", help="Log ndjson to file")

    return parser.parse_known_args()[0] if known else parser.parse_args()

```

ÂèÇÊï∞ÁöÑÂÖ∑‰ΩìËß£ÊûêÂ¶Ç‰∏ãÔºö

```python
"""
    optÊ®°Âûã‰∏ªË¶ÅÂèÇÊï∞Ëß£ÊûêÔºö
    --weightsÔºöÂàùÂßãÂåñÁöÑÊùÉÈáçÊñá‰ª∂ÁöÑË∑ØÂæÑÂú∞ÂùÄ
    --cfgÔºöÊ®°ÂûãyamlÊñá‰ª∂ÁöÑË∑ØÂæÑÂú∞ÂùÄ
    --dataÔºöÊï∞ÊçÆyamlÊñá‰ª∂ÁöÑË∑ØÂæÑÂú∞ÂùÄ
    --hypÔºöË∂ÖÂèÇÊï∞Êñá‰ª∂Ë∑ØÂæÑÂú∞ÂùÄ
    --epochsÔºöËÆ≠ÁªÉËΩÆÊ¨°
    --batch-sizeÔºöÂñÇÂÖ•ÊâπÊ¨°Êñá‰ª∂ÁöÑÂ§öÂ∞ë
    --img-sizeÔºöËæìÂÖ•ÂõæÁâáÂ∞∫ÂØ∏
    --rect:ÊòØÂê¶ÈááÁî®Áü©ÂΩ¢ËÆ≠ÁªÉÔºåÈªòËÆ§False
    --resume:Êé•ÁùÄÊâìÊñ≠ËÆ≠ÁªÉ‰∏äÊ¨°ÁöÑÁªìÊûúÊé•ÁùÄËÆ≠ÁªÉ
    --nosave:‰∏ç‰øùÂ≠òÊ®°ÂûãÔºåÈªòËÆ§False
    --notest:‰∏çËøõË°åtestÔºåÈªòËÆ§False
    --noautoanchor:‰∏çËá™Âä®Ë∞ÉÊï¥anchorÔºåÈªòËÆ§False
    --evolve:ÊòØÂê¶ËøõË°åË∂ÖÂèÇÊï∞ËøõÂåñÔºåÈªòËÆ§False
    --bucket:Ë∞∑Ê≠å‰∫ëÁõòbucketÔºå‰∏ÄËà¨‰∏ç‰ºöÁî®Âà∞
    --cache-images:ÊòØÂê¶ÊèêÂâçÁºìÂ≠òÂõæÁâáÂà∞ÂÜÖÂ≠òÔºå‰ª•Âä†Âø´ËÆ≠ÁªÉÈÄüÂ∫¶ÔºåÈªòËÆ§False
    --image-weightsÔºö‰ΩøÁî®Âä†ÊùÉÂõæÂÉèÈÄâÊã©ËøõË°åËÆ≠ÁªÉ
    --device:ËÆ≠ÁªÉÁöÑËÆæÂ§áÔºåcpuÔºõ0(Ë°®Á§∫‰∏Ä‰∏™gpuËÆæÂ§ácuda:0)Ôºõ0,1,2,3(Â§ö‰∏™gpuËÆæÂ§á)
    --multi-scale:ÊòØÂê¶ËøõË°åÂ§öÂ∞∫Â∫¶ËÆ≠ÁªÉÔºåÈªòËÆ§False
    --single-cls:Êï∞ÊçÆÈõÜÊòØÂê¶Âè™Êúâ‰∏Ä‰∏™Á±ªÂà´ÔºåÈªòËÆ§False
    --adam:ÊòØÂê¶‰ΩøÁî®adam‰ºòÂåñÂô®
    --sync-bn:ÊòØÂê¶‰ΩøÁî®Ë∑®Âç°ÂêåÊ≠•BN,Âú®DDPÊ®°Âºè‰ΩøÁî®
    --local_rankÔºöDDPÂèÇÊï∞ÔºåËØ∑Âãø‰øÆÊîπ
    --workersÔºöÊúÄÂ§ßÂ∑•‰ΩúÊ†∏ÂøÉÊï∞
    --project:ËÆ≠ÁªÉÊ®°ÂûãÁöÑ‰øùÂ≠ò‰ΩçÁΩÆ
    --nameÔºöÊ®°Âûã‰øùÂ≠òÁöÑÁõÆÂΩïÂêçÁß∞
    --exist-okÔºöÊ®°ÂûãÁõÆÂΩïÊòØÂê¶Â≠òÂú®Ôºå‰∏çÂ≠òÂú®Â∞±ÂàõÂª∫
"""
```

### Â∏∏Áî®ÁöÑÂèÇÊï∞

`weights`È¢ÑËÆ≠ÁªÉÊùÉÈáç`yolov5s.pt`Ôºå‰∏éÂâçÈù¢‰øÆÊîπÁöÑÊñá‰ª∂Ë¶Å‰∏ÄËá¥„ÄÇ

```python
parser.add_argument("--weights", type=str, default=ROOT / "yolov5s.pt", help="initial weights path")
```

`data`Êï∞ÊçÆyamlÊñá‰ª∂ÁöÑË∑ØÂæÑÂú∞ÂùÄÔºåÂêåÊ†∑‰∏éÂâçÈù¢‰øÆÊîπÁöÑÊñá‰ª∂‰øùÊåÅ‰∏ÄËá¥„ÄÇ

```python
parser.add_argument("--data", type=str, default=ROOT / "data/coco128.yaml", help="dataset.yaml path")
```

`epochs`ËÆ≠ÁªÉËΩÆÊï∞ÔºåË¶ÅËææÂà∞Êõ≤Á∫øÊãüÂêàÔºåÊúÄÂ•Ω‰ªé100Êàñ300ËΩÆÂºÄÂßã„ÄÇ

`batch-size`ÊâπÊ¨°Êñá‰ª∂ÁöÑÂ§öÂ∞ë,Ëøô‰∏™ÁúãÁîµËÑëÁöÑÊÄßËÉΩ„ÄÇ

`img-size`ÁÖßÁâáÁöÑÂ∞∫ÂØ∏Ôºå‰∏ÄËà¨Â∞±ÈÄâ320„ÄÇ

```python
parser.add_argument("--epochs", type=int, default=10, help="total training epochs")
parser.add_argument("--batch-size", type=int, default=8, help="total batch size for all GPUs, -1 for autobatch")
parser.add_argument("--imgsz", "--img", "--img-size", type=int, default=320, help="train, val image size (pixels)")
```

`workers`ÊúÄÂ§ßÂ∑•‰ΩúÊ†∏ÂøÉÊï∞ÔºåËøô‰∏™ÁúãÁîµËÑëÁöÑÊÄßËÉΩ„ÄÇ

```python
parser.add_argument("--workers", type=int, default=8, help="max dataloader workers (per RANK in DDP mode)")
```

## ËÆ≠ÁªÉÊ®°Âûã

Áõ¥Êé•ËøêË°å`train.py`

![1715785697877](yoloËÆ≠ÁªÉ/1715785697877.png)

### ËÆ≠ÁªÉÁªìÊûú

ËøôÈáåÊñá‰ª∂Â§π‰∏ãÊúâÊµãËØïÁªìÊûúÔºåËÆ≠ÁªÉÁªìÊûúÊõ≤Á∫øÁ≠â‰ø°ÊÅØ„ÄÇ

![1716220655982](yoloËÆ≠ÁªÉ/1716220655982.png)

**ÊùÉÈáçÊñá‰ª∂**ÔºàÊúÄÂêéË¶ÅËé∑ÂæóÂ∞±ÊòØËøô‰∏™Êñá‰ª∂ÔºåÂèñ**best.pt**ÂÅöÊé®ÁêÜ‰ΩøÁî®ÁöÑÊùÉÈáçÔºâ

![1715785770478](yoloËÆ≠ÁªÉ/1715785770478.png)

### Áî®tensorbordÊü•ÁúãËÆ≠ÁªÉÁªìÊûú

ÊâìÂºÄpycharmÁªàÁ´ØÔºåËæìÂÖ•Â¶Ç‰∏ãÂëΩ‰ª§Ôºö

```python
tensorboard --logdir=runs/train
```

![1716220466965](yoloËÆ≠ÁªÉ/1716220466965.png)

ctrlÁÇπÂáªÁΩëÂùÄÔºåË∑≥ËΩ¨ÊµèËßàÂô®Ôºö

![1716220527191](yoloËÆ≠ÁªÉ/1716220527191.png)

